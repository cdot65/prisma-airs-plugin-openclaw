{
  "id": "prisma-airs",
  "name": "Prisma AIRS Security",
  "description": "AI Runtime Security - full AIRS detection suite with audit logging, context injection, outbound blocking, and tool gating",
  "version": "0.3.0-alpha.0",
  "entrypoint": "index.ts",
  "hooks": [
    "hooks/prisma-airs-guard",
    "hooks/prisma-airs-audit",
    "hooks/prisma-airs-context",
    "hooks/prisma-airs-outbound",
    "hooks/prisma-airs-tools"
  ],
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "profile_name": {
        "type": "string",
        "default": "default",
        "description": "Prisma AIRS profile name from Strata Cloud Manager"
      },
      "app_name": {
        "type": "string",
        "default": "openclaw",
        "description": "Application name for scan metadata"
      },
      "reminder_mode": {
        "type": "string",
        "enum": ["on", "off"],
        "default": "on",
        "description": "Inject security scanning reminder on agent bootstrap"
      },
      "audit_mode": {
        "type": "string",
        "enum": ["deterministic", "probabilistic", "off"],
        "default": "deterministic",
        "description": "Audit logging mode: deterministic (hook, always scan), probabilistic (tool, model decides), or off"
      },
      "context_injection_mode": {
        "type": "string",
        "enum": ["deterministic", "probabilistic", "off"],
        "default": "deterministic",
        "description": "Context injection mode: deterministic (hook, always inject), probabilistic (tool, model decides), or off"
      },
      "outbound_mode": {
        "type": "string",
        "enum": ["deterministic", "probabilistic", "off"],
        "default": "deterministic",
        "description": "Outbound scanning mode: deterministic (hook, always scan), probabilistic (tool, model decides), or off"
      },
      "tool_gating_mode": {
        "type": "string",
        "enum": ["deterministic", "probabilistic", "off"],
        "default": "deterministic",
        "description": "Tool gating mode: deterministic (hook, always gate), probabilistic (tool, model decides), or off"
      },
      "reminder_enabled": {
        "type": "boolean",
        "default": true,
        "description": "DEPRECATED: Use reminder_mode instead. Inject security scanning reminder on agent bootstrap",
        "deprecated": true
      },
      "audit_enabled": {
        "type": "boolean",
        "default": true,
        "description": "DEPRECATED: Use audit_mode instead. Enable audit logging of all inbound messages",
        "deprecated": true
      },
      "context_injection_enabled": {
        "type": "boolean",
        "default": true,
        "description": "DEPRECATED: Use context_injection_mode instead. Inject security warnings into agent context",
        "deprecated": true
      },
      "outbound_scanning_enabled": {
        "type": "boolean",
        "default": true,
        "description": "DEPRECATED: Use outbound_mode instead. Enable scanning and blocking of outbound responses",
        "deprecated": true
      },
      "tool_gating_enabled": {
        "type": "boolean",
        "default": true,
        "description": "DEPRECATED: Use tool_gating_mode instead. Block dangerous tools when threats are detected",
        "deprecated": true
      },
      "fail_closed": {
        "type": "boolean",
        "default": true,
        "description": "Block messages when AIRS scan fails (default: true for security)"
      },
      "dlp_mask_only": {
        "type": "boolean",
        "default": true,
        "description": "Mask DLP violations instead of blocking (when no other violations)"
      },
      "high_risk_tools": {
        "type": "array",
        "items": { "type": "string" },
        "default": [
          "exec",
          "Bash",
          "bash",
          "write",
          "Write",
          "edit",
          "Edit",
          "gateway",
          "message",
          "cron"
        ],
        "description": "Tools to block on any detected threat"
      },
      "api_key": {
        "type": "string",
        "description": "Prisma AIRS API key from Strata Cloud Manager"
      }
    }
  },
  "uiHints": {
    "api_key": {
      "label": "API Key",
      "sensitive": true,
      "placeholder": "Enter your PANW AI Security API key"
    },
    "profile_name": {
      "label": "Profile Name",
      "placeholder": "default"
    },
    "app_name": {
      "label": "Application Name",
      "placeholder": "openclaw"
    },
    "reminder_mode": {
      "label": "Reminder Mode",
      "description": "on: inject scanning reminder at agent bootstrap; off: no reminder"
    },
    "audit_mode": {
      "label": "Audit Mode",
      "description": "deterministic: scan every inbound message via hook; probabilistic: model decides when to scan via tool; off: disabled"
    },
    "context_injection_mode": {
      "label": "Context Injection Mode",
      "description": "deterministic: always inject security context via hook; probabilistic: model decides when to scan via tool; off: disabled"
    },
    "outbound_mode": {
      "label": "Outbound Scanning Mode",
      "description": "deterministic: scan every outbound response via hook; probabilistic: model decides when to scan via tool; off: disabled"
    },
    "tool_gating_mode": {
      "label": "Tool Gating Mode",
      "description": "deterministic: always gate tool calls via hook; probabilistic: model checks tool safety via tool; off: disabled"
    },
    "reminder_enabled": {
      "label": "Enable Bootstrap Reminder (deprecated)",
      "description": "DEPRECATED: Use reminder_mode instead"
    },
    "audit_enabled": {
      "label": "Enable Audit Logging (deprecated)",
      "description": "DEPRECATED: Use audit_mode instead"
    },
    "context_injection_enabled": {
      "label": "Enable Context Injection (deprecated)",
      "description": "DEPRECATED: Use context_injection_mode instead"
    },
    "outbound_scanning_enabled": {
      "label": "Enable Outbound Scanning (deprecated)",
      "description": "DEPRECATED: Use outbound_mode instead"
    },
    "tool_gating_enabled": {
      "label": "Enable Tool Gating (deprecated)",
      "description": "DEPRECATED: Use tool_gating_mode instead"
    },
    "fail_closed": {
      "label": "Fail Closed",
      "description": "Block on scan failure (recommended for security)"
    },
    "dlp_mask_only": {
      "label": "DLP Mask Only",
      "description": "Mask sensitive data instead of blocking"
    },
    "high_risk_tools": {
      "label": "High Risk Tools",
      "description": "Tools blocked on any threat detection"
    }
  },
  "requires": {}
}
